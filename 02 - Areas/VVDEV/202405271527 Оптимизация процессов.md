---
date:
  - 27/05/2024 15:27
tags:
  - devops
  - vvdev/devops
cssclasses:
  - image-borders
  - neutral-pen-black
  - page-manila
---
# Предложение по улучшениям

## Ускорение процесса сборки
Чтобы ускорить сборку Docker-образов, следуйте этим основным шагам:

1. **Оптимизация Dockerfile**:
    
    - **Используйте кэширование слоёв**: изменяйте порядок команд так, чтобы редко изменяющиеся части (например, установка зависимостей) были выше.
    - **Уменьшение контекста сборки**: используйте `.dockerignore`, чтобы исключить ненужные файлы.
    - **Мультистейдж сборка**: разделите сборку и финальный образ, чтобы в финальном образе были только необходимые файлы.
2. **Выбор базового образа**:
    
    - Используйте легкие образы, например, на основе Alpine Linux.
3. **Оптимизация CI/CD процессов**:
    
    - Используйте предыдущие образы для кэширования в CI/CD.

Подробнее о каждом шаге можно прочитать в [статье на Habr](https://habr.com/en/companies/itsumma/articles/501680/).
## Ускорение Gitlab CI пайплайнов
Для ускорения GitLab CI/CD пайплайнов выполните следующие шаги:

1. **Кэширование Docker-образов**:
   - Используйте `--cache-from` для ускорения сборки.

2. **Оптимизация политики скачивания Docker-образов**:
   - Настройте `pull_policy` на своих раннерах, используя `if-not-present`.

3. **Кэширование CI/CD**:
   - Настройте кэширование зависимостей и выберите правильную политику кэширования (`pull`, `push`).

4. **Изменение уровня компрессии**:
   - Настройте уровень компрессии артефактов и кэша.

5. **Стратегия git клонирования**:
   - Настройте `GIT_STRATEGY` для уменьшения времени клонирования репозитория.

Подробнее читайте в статье на [Habr](https://habr.com/en/companies/gitlab/articles/646579/).

## Репликация
С недавнего времени, репликация стала доступна на уровне docker-compose файла. Выполняется простым действием
```yaml
services:
  myapp:
    image: awesome/webapp
    deploy:
      mode: replicated
      replicas: 6
```
Стоит подметить, что репликация будет игнорироваться, если будет определено имя контейнера. Необходимо позволить докеры самостоятельно генерировать имена.